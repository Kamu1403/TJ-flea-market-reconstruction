<!DOCTYPE html>
<html lang="en">
<<<<<<< Updated upstream
  <head>
    <meta charset="utf-8" />
    <meta name="author" content="Kodinger" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>My Login Page</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="{{url_for('static',filename='img/icon/favicon.png')}}"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="{{url_for('static',filename='css/my-login.css')}}"
    />
  </head>

  <body class="my-login-page">
    <section class="h-100">
      <div class="container h-100">
        <div class="row justify-content-md-center h-100">
          <div class="card-wrapper">
            <div class="brand">
              <img
                src="{{url_for('static',filename='img/logo/logo.jpg')}}"
                alt="logo"
              />
            </div>
            <div class="card fat">
              <div class="card-body">
                <h4 class="card-title">密码登录</h4>
                <form method="POST" class="my-login-validation" novalidate="">
                  <div class="form-group">
                    <label for="email">邮箱地址</label>
                    <input
                      id="email"
                      type="email"
                      class="form-control"
                      placeholder="学号@tongji.edu.cn"
                      name="email"
                      value=""
                      required
                      autofocus
                    />
                    <div class="invalid-feedback">
                      邮箱格式不正确或该邮箱用户不存在
                    </div>
                  </div>
=======
    <head>
        <meta charset="utf-8" />
        <meta name="author" content="Kodinger" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>My Login Page</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" />
        <link rel="stylesheet" type="text/css" href="../static/css/my-login.css" />
    </head>

    <body class="my-login-page">
        <section class="h-100">
            <div class="container h-100">
                <div class="row justify-content-md-center h-100">
                    <div class="card-wrapper">
                        <div class="brand">
                            <img src="../static/img/logo.jpg" alt="logo" />
                        </div>
                        <div class="card fat">
                            <div class="card-body">
                                <h4 class="card-title">密码登录</h4>
                                <form method="POST" class="my-login-validation" novalidate="">
                                    <div class="form-group">
                                        <label for="email">邮箱地址</label>
                                        <input id="email" type="email" class="form-control" placeholder="学号@tongji.edu.cn" name="email" value="" required autofocus />
                                        <div class="invalid-feedback">邮箱格式不正确或该邮箱用户不存在</div>
                                    </div>
>>>>>>> Stashed changes

                                    <div class="form-group">
                                        <label for="password"
                                            >密码
                                            <a href="forgot.html" class="float-right"> 忘记密码? </a>
                                        </label>
                                        <input id="password" type="password" class="form-control" name="password" required data-eye />
                                        <div class="invalid-feedback">请输入密码</div>
                                    </div>

                                    <div class="form-group">
                                        <div class="custom-checkbox custom-control">
                                            <input type="checkbox" name="remember" id="remember" class="custom-control-input" />
                                            <label for="remember" class="custom-control-label">记住我</label>
                                        </div>
                                    </div>

                                    <div class="form-group m-0">
                                        <button type="submit" class="btn btn-primary btn-block" onclick="password_login()">登录</button>
                                    </div>
                                    <div class="mt-4 text-center">
                                        或选择验证码注册或登录?
                                        <a href="verify_login.html">验证码</a>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

<<<<<<< Updated upstream
    <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>
    <script src="{{url_for('static',filename='js/my-login.js')}}"></script>
    <script type="text/javascript">
      //会不会冲突
      function password_login() {
        var user_id = $("#email").val(); //获取邮箱，学号
        var password = $("#password").val();
        var remember_me = $("renmenber")[0].checked; //是否选中记住我，应该是1或0
        //还是检验是否为空
        var form = $(this); // 0是邮箱，1是密码 2  user_id
        if (form[0].checkValidity() === false) {
          event.preventDefault();
          event.stopPropagation();
          return false;
        }
=======
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
        <script src="../static/js/my-login.js"></script>
        <script type="text/javascript">
            //会不会冲突
            function password_login() {
                var user_id = $("#email").val(); //获取邮箱，学号
                var password = $("#password").val();
                console.log(user_id);
                console.log(password);
                //var remember_me = $("renmenber")[0].checked; //是否选中记住我，应该是1或0
                //还是检验是否为空
                var form = $(this); // 0是邮箱，1是密码 2是user_id
                if (form[0].checkValidity() === false) {
                    event.preventDefault();
                    event.stopPropagation();
                    return false;
                }
>>>>>>> Stashed changes

                var fd = new FormData();
                fd.append("user_id", user_id);
                fd.append("password", password);
                //fd.append("remember_id", remember_me); //
                console.log(fd);
                //这个或许不是这个意思，这是改变样式的
                $.ajax({
                    type: "POST",
                    url: "/api/login_using_password",
                    data: fd,
                    // dataTypes: 指定返回数据的类型
                    success: function (data) {
                        //返回的数据
                        console.log(data);
                        if (data.statusCode == 200) {
                            //跳转   window.location.href=("/index2")  //这个是成功后的跳转页面,路由，怎么跳转？
                            alert("登陆成功");
                            console.log("OK");
                        } else if (data.statusCode == 400) {
                            //400,登录失败
                            alert(data.message);
                            console.log(data.message);
                        }
                    },
                    error: function () {
                        // 访问不了接口或者dataType类型不对
                        alert(data.message);
                        console.log(data.message);
                    },
                });
            }
        </script>
    </body>
</html>
